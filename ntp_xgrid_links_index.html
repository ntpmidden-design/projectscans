<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NTP Xgrid – Projectlinks</title>
  <meta name="description" content="Eenvoudige pagina om links naar Xgrid-projecten te delen." />
  <!-- Tailwind via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root { color-scheme: light dark; }
    /* NTP-kleuren */
    .ntp-primary { @apply bg-[#E94E1B] text-white; }
    .ntp-primary-text { color: #E94E1B; }
    .ntp-accent { @apply bg-[#00AEEF] text-white; }
    .ntp-accent-text { color: #00AEEF; }
    .thumb-placeholder { @apply w-full h-32 flex items-center justify-center text-white text-lg font-bold; }
  </style>
</head>
<body class="bg-white dark:bg-neutral-950 text-neutral-900 dark:text-neutral-100 min-h-screen font-sans">
  <div class="max-w-6xl mx-auto p-6">
    <header class="flex flex-col sm:flex-row sm:items-end sm:justify-between gap-4 border-b-4 border-[#00AEEF] pb-4">
      <div class="flex items-center gap-3">
        <img src="Logo_NTP.png" alt="NTP logo" class="h-12 w-auto" />
        <div>
          <h1 class="text-2xl sm:text-3xl font-bold tracking-tight ntp-accent-text">NTP Xgrid – Projectlinks</h1>
          <p class="text-sm text-neutral-500 dark:text-neutral-400">Snel delen van gescande projecten</p>
        </div>
      </div>
      <div class="flex items-center gap-2">
        <input id="search" type="search" placeholder="Zoek projecten…" class="w-72 max-w-full px-3 py-2 rounded-xl border border-neutral-200 dark:border-neutral-800 bg-white/70 dark:bg-neutral-900/70 backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-[#00AEEF]" />
      </div>
    </header>

    <section class="mt-6">
      <div class="flex flex-wrap items-center gap-2 text-sm">
        <span class="text-neutral-500">Filter:</span>
        <button data-filter="all" class="filter-btn px-3 py-1 rounded-full border border-neutral-200 dark:border-neutral-800 hover:bg-[#00AEEF] hover:text-white">Alles</button>
        <button data-filter="public" class="filter-btn px-3 py-1 rounded-full border border-neutral-200 dark:border-neutral-800 hover:bg-[#00AEEF] hover:text-white">Publiek</button>
        <button data-filter="private" class="filter-btn px-3 py-1 rounded-full border border-neutral-200 dark:border-neutral-800 hover:bg-[#00AEEF] hover:text-white">Privé</button>
      </div>

      <ul id="list" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6 mt-4"></ul>

      <div id="empty" class="hidden text-center text-neutral-500 py-16">
        Geen resultaten…
      </div>
    </section>

    <footer class="mt-10 text-xs text-neutral-500 dark:text-neutral-400 border-t border-neutral-200 dark:border-neutral-800 pt-4">
      <p>
        © NTP – Voeg projecten toe in het <code>links</code>-blok in dit bestand.
      </p>
    </footer>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/qrious@4.0.2/dist/qrious.min.js"></script>

  <script>
    const links = [
      { id: "nijkerk-depot", title: "Nijkerk – Depot", url: "https://lcc-viewer.xgrids.com/pub/dbmahu-depot_nijerk", client: "NTP", tags: ["scan", "depot"], visibility: "private", secret: "NTP2025" },
      { id: "westervoort", title: "Westervoort", url: "https://lcc-viewer.xgrids.com/pub/dbmahu-westervoort", client: "NTP", tags: ["scan"], visibility: "private", secret: "NTP2025" },
      { id: "huizen-1", title: "Huizen – Stadenlande 1", url: "https://lcc-viewer.xgrids.com/pub/dbmahu-huizen_stadenlande_1", client: "NTP", tags: ["scan", "huizen"], visibility: "private", secret: "NTP2025" },
      { id: "huizen-2", title: "Huizen – Stadenlande 2", url: "https://lcc-viewer.xgrids.com/pub/dbmahu-huizen_stadenlande_2", client: "NTP", tags: ["scan", "huizen"], visibility: "private", secret: "NTP2025" },
      { id: "doetinchem-1", title: "Doetinchem 1", url: "https://lcc-viewer.xgrids.com/pub/dbmahu-doetinchem_1", client: "NTP", tags: ["scan", "doetinchem"], visibility: "private", secret: "NTP2025" }
    ];

    const colors = ["bg-[#00AEEF]", "bg-[#E94E1B]", "bg-yellow-500", "bg-green-600", "bg-purple-600"];

    const listEl = document.getElementById('list');
    const emptyEl = document.getElementById('empty');
    const searchEl = document.getElementById('search');

    let activeFilter = 'all';

    function matchesSearch(item, q) {
      if (!q) return true;
      const hay = [item.title, item.client, ...(item.tags||[])].join(' ').toLowerCase();
      return hay.includes(q.toLowerCase());
    }

    function matchesFilter(item) {
      if (activeFilter === 'all') return true;
      return (item.visibility || 'public') === activeFilter;
    }

    function render(items) {
      listEl.innerHTML = '';
      if (!items.length) {
        emptyEl.classList.remove('hidden');
        return;
      }
      emptyEl.classList.add('hidden');

      const sorted = [...items].sort((a,b) => (b.date||'').localeCompare(a.date||''));

      sorted.forEach((item, i) => {
        const li = document.createElement('li');
        li.className = "rounded-2xl border border-neutral-200 dark:border-neutral-800 overflow-hidden bg-white/60 dark:bg-neutral-900/60 shadow flex flex-col";

        // Thumbnail placeholder
        const thumb = document.createElement('div');
        thumb.className = `thumb-placeholder ${colors[i % colors.length]}`;
        thumb.textContent = item.title.split(' ')[0];
        li.appendChild(thumb);

        const content = document.createElement('div');
        content.className = "p-4 flex flex-col gap-3 flex-1";

        const header = document.createElement('div');
        header.className = 'flex items-start justify-between gap-2';

        const h3 = document.createElement('h3');
        h3.className = 'font-semibold leading-snug';
        h3.textContent = item.title;

        const chip = document.createElement('span');
        const vis = (item.visibility || 'public');
        chip.textContent = vis === 'private' ? 'Privé' : 'Publiek';
        chip.className = 'text-xs px-2 py-0.5 rounded-full border border-neutral-200 dark:border-neutral-800';

        header.append(h3, chip);
        content.appendChild(header);

        if (item.client) {
          const meta = document.createElement('div');
          meta.className = 'text-xs text-neutral-500';
          meta.textContent = item.client;
          content.appendChild(meta);
        }

        if (item.tags?.length) {
          const tags = document.createElement('div');
          tags.className = 'flex flex-wrap gap-1';
          item.tags.forEach(t => {
            const s = document.createElement('span');
            s.textContent = `#${t}`;
            s.className = 'text-[11px] px-2 py-0.5 rounded-full bg-[#00AEEF]/20 text-[#00AEEF]';
            tags.appendChild(s);
          });
          content.appendChild(tags);
        }

        const btnRow = document.createElement('div');
        btnRow.className = 'mt-1 flex items-center gap-2';

        const openBtn = document.createElement('a');
        openBtn.href = item.url;
        openBtn.target = '_blank';
        openBtn.rel = 'noopener';
        openBtn.textContent = 'Openen';
        openBtn.className = 'px-3 py-1.5 rounded-xl ntp-accent hover:opacity-90 text-sm';

        const copyBtn = document.createElement('button');
        copyBtn.textContent = 'Kopieer link';
        copyBtn.className = 'px-3 py-1.5 rounded-xl border border-neutral-200 dark:border-neutral-800 hover:bg-[#00AEEF]/10 text-sm';
        copyBtn.addEventListener('click', async () => {
          await navigator.clipboard.writeText(item.url);
          copyBtn.textContent = 'Gekopieerd!';
          setTimeout(() => copyBtn.textContent = 'Kopieer link', 1200);
        });

        const qrBtn = document.createElement('button');
        qrBtn.textContent = 'QR';
        qrBtn.className = 'px-3 py-1.5 rounded-xl border border-neutral-200 dark:border-neutral-800 hover:bg-[#00AEEF]/10 text-sm';
        qrBtn.addEventListener('click', () => showQR(item.url, item.title));

        btnRow.append(openBtn, copyBtn, qrBtn);
        content.appendChild(btnRow);

        li.appendChild(content);
        listEl.appendChild(li);
      });
    }

    function apply() {
      const q = searchEl.value.trim();
      const filtered = links.filter(it => matchesSearch(it, q) && matchesFilter(it));
      render(filtered);
    }

    document.querySelectorAll('.filter-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('ring-2','ring-[#00AEEF]'));
        btn.classList.add('ring-2','ring-[#00AEEF]');
        activeFilter = btn.dataset.filter;
        apply();
      });
    });

    searchEl.addEventListener('input', apply);

    function showQR(url, title) {
      let overlay = document.getElementById('qrOverlay');
      if (!overlay) {
        overlay = document.createElement('div');
        overlay.id = 'qrOverlay';
        overlay.className = 'fixed inset-0 bg-black/50 grid place-items-center p-6';
        overlay.innerHTML = `
          <div class=\"bg-white dark:bg-neutral-900 rounded-2xl p-6 w-full max-w-sm border border-neutral-200 dark:border-neutral-800\">\n            <div class=\"flex items-start justify-between mb-4\">\n              <h2 class=\"font-semibold\" id=\"qrTitle\"></h2>\n              <button id=\"qrClose\" class=\"text-sm px-2 py-1 rounded-lg border border-neutral-200 dark:border-neutral-800\">Sluiten</button>\n            </div>\n            <canvas id=\"qrCanvas\" class=\"mx-auto\"></canvas>\n            <p class=\"mt-3 text-xs text-center text-neutral-500\">Scan met je telefoon om te openen.</p>\n          </div>`;
        document.body.appendChild(overlay);
        overlay.addEventListener('click', (e) => { if (e.target === overlay) overlay.remove(); });
        overlay.querySelector('#qrClose').addEventListener('click', () => overlay.remove());
      }
      overlay.querySelector('#qrTitle').textContent = title || 'Link';
      const qr = new QRious({ element: overlay.querySelector('#qrCanvas'), value: url, size: 240 });
    }

    apply();
  </script>
</body>
</html>
